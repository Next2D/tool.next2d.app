var R=Object.defineProperty;var U=(t,e,s)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var r=(t,e,s)=>(U(t,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const _ of i.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&n(_)}).observe(document,{childList:!0,subtree:!0});function s(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=s(o);fetch(o.href,i)}})();const a="tools",b="arrow",D="bucket",B="circle",A="setting",P="export",G="free-transform",k="hand",H="load",Y="save",z="pen",X="rectangle",F="round-rect",W="shape-transform",V="text",K="zoom-minus",j="zoom-plus",y=`${a}-${A}`,Z="screen-scale";class c{static get MOUSE_DOWN(){return"pointerdown"}static get MOUSE_UP(){return"pointerup"}static get MOUSE_MOVE(){return"pointermove"}static get START(){return"start"}static get END(){return"end"}static get DBL_CLICK(){return"dblclick"}static get CHANGE(){return"change"}static get MOUSE_OVER(){return"pointerover"}static get MOUSE_OUT(){return"pointerout"}static get KEY_DOWN(){return"keydown"}static get MOUSE_LEAVE(){return"pointerleave"}}let h=null;const q=()=>h,M=t=>{h&&h.dispatchEvent(c.END),h=t,t.dispatchEvent(c.START)},J=new Map,Q=t=>{J.set(t.name,t)},tt=t=>{t.stopPropagation();const e=q();e&&e.dispatchEvent(c.MOUSE_MOVE,t)};let T="auto";const g=(t="auto")=>{T!==t&&(T=t,document.documentElement.style.setProperty("--tool-cursor",t))},f=(t,e,s)=>{const n=+t;return Math.min(Math.max(e,isNaN(n)||!isFinite(n)?0:n),s)},et=t=>{},st=t=>{},nt=t=>{t.stopPropagation(),g("auto")},d=new Map,ot=t=>{d.set(t.name,t)},N=t=>d.has(t)?d.get(t):null,rt=()=>d,E=(t="")=>{const e=rt();for(const s of e.values())s.name!==t&&s.hide()},it=()=>{E()},ct=()=>{const t=document.getElementById(a);t&&(t.addEventListener(c.MOUSE_DOWN,()=>{it()}),t.addEventListener(c.MOUSE_MOVE,e=>{tt(e)}),t.addEventListener(c.MOUSE_OUT,e=>{nt(e)}))};class lt{constructor(){r(this,"_$events");this._$events=new Map}addEventListener(e,s){this._$events.has(e)||this._$events.set(e,[]);const n=this._$events.get(e);n&&n.push(s)}dispatchEvent(e,s=null){if(!this._$events.has(e))return;const n=this._$events.get(e);if(!(!n||!n.length))for(let o=0;o<n.length;++o){const i=n[o];i(s)}}}class at extends lt{constructor(s=""){super();r(this,"_$name");r(this,"_$active");r(this,"_$target");this._$name=`${s}`,this._$active=!1,this._$target=null,this._$initialize()}_$initialize(){this.addEventListener(c.MOUSE_DOWN,s=>{s.stopPropagation(),this.activation(s)}),this.addEventListener(c.MOUSE_UP,s=>{s.stopPropagation(),this.termination()}),this.addEventListener(c.START,()=>{this.toolStart()}),this.addEventListener(c.END,()=>{this.toolEnd()})}get name(){return this._$name}get active(){return this._$active}set active(s){this._$active=!!s}get target(){return this._$target}set target(s){this._$target=s}activation(s){this._$active=!0,this._$target=s.currentTarget}termination(){this._$active=!1,this._$target=null}toolStart(){g("auto");const s=document.getElementById(`${a}-${this._$name}`);!s||s.dataset.mode!=="tool"||s.classList.add("active")}toolEnd(){g("auto");const s=document.getElementById(`${a}-${this._$name}`);s&&s.classList.remove("active")}}const ut=(t,e)=>{t.stopPropagation(),E(),M(e)};class l extends at{constructor(s=""){super(s);r(this,"_$cursor");r(this,"_$pageX");r(this,"_$pageY");r(this,"_$offsetX");r(this,"_$offsetY");this._$cursor="auto",this._$pageX=0,this._$pageY=0,this._$offsetX=0,this._$offsetY=0,s&&this._$register(s)}_$register(s){const n=document.getElementById(`${a}-${s}`);!n||n.dataset.mode!=="tool"||(Q(this),n.addEventListener(c.MOUSE_DOWN,o=>{ut(o,this)}))}get pageX(){return this._$pageX}set pageX(s){this._$pageX=s}get pageY(){return this._$pageY}set pageY(s){this._$pageY=s}get offsetX(){return this._$offsetX}set offsetX(s){this._$offsetX=s}get offsetY(){return this._$offsetY}set offsetY(s){this._$offsetY=s}get cursor(){return this._$cursor}setIcon(s){const n=document.getElementById(`${a}-${this.name}`);if(n){for(;n.children.length;)n.children[0].remove();n.appendChild(s)}}setToolTip(s){const n=document.getElementById(`${a}-${this.name}`);n&&(n.dataset.detail=`${s}`)}setCursor(s="auto"){this._$cursor=`${s}`}}const $t=t=>{M(t)};class ht extends l{constructor(){super(b)}async initialize(){$t(this)}}class dt extends l{constructor(){super(G);r(this,"_$validity");this._$validity=!1}get validity(){return this._$validity}}class _t extends l{constructor(){super(D)}}class m extends l{constructor(e){super(e)}}class ft extends m{constructor(){super(B)}}class gt extends l{constructor(){super(k)}}class Et extends l{constructor(){super(z)}}class mt extends m{constructor(){super(X)}}class pt extends m{constructor(){super(F)}}class Tt extends l{constructor(){super(V)}}class Ot extends l{constructor(){super(W)}}class St extends l{constructor(){super(j)}}class Lt extends l{constructor(){super(K)}}class xt extends l{constructor(){super(Y)}}class vt extends l{constructor(){super(H)}}class It extends l{constructor(){super(P)}}const $="user-setting",At=()=>{const t=N($);t&&t.show()},yt=t=>{t.stopPropagation(),E($),At()};class Mt extends l{constructor(){super(A)}async initialize(){this._$registerEvent()}_$registerEvent(){const e=document.getElementById(y);e&&e.addEventListener(c.MOUSE_DOWN,s=>{yt(s)})}}const Nt=()=>{const t=[ht,dt,_t,ft,gt,Et,mt,pt,Tt,Ot,St,Lt,xt,vt,It,Mt],e=[];for(let s=0;s<t.length;++s){const n=t[s],o=new n;o.initialize&&o.initialize()}return Promise.all(e)},wt=()=>(ct(),Nt()),Ct=()=>new Promise(t=>{wt().then(()=>{t()})});class Rt{constructor(e){r(this,"_$element");r(this,"_$name");r(this,"_$state");r(this,"_$offsetLeft");r(this,"_$offsetTop");this._$name=`${e}`,this._$state="hide",this._$offsetLeft=0,this._$offsetTop=0,this._$element=document.getElementById(e),ot(this)}get name(){return this._$name}get offsetLeft(){return this._$offsetLeft}set offsetLeft(e){this._$offsetLeft=e}get offsetTop(){return this._$offsetTop}set offsetTop(e){this._$offsetTop=e}show(){this._$state!=="show"&&(this._$state="show",this._$element&&(this.move(this._$element),this._$element.setAttribute("class","fadeIn")))}hide(){this._$state!=="hide"&&(this._$state="hide",this._$element&&this._$element.setAttribute("class","fadeOut"))}move(e){return e}}const O=()=>{const t=N($);if(!t)return;const e=document.getElementById($);if(!e)return;const s=document.getElementById(y);s&&(t.offsetLeft=s.offsetLeft+30,t.offsetTop=s.offsetTop-e.clientHeight+80)},Ut="publish-layer-setting",bt="publish-type-setting",Dt="modal-setting",Bt="current-version",Pt="__next2d-tools__",w=`${Pt}@user-setting`,u=()=>{const t=localStorage.getItem(w);return t?JSON.parse(t):{layer:!1,type:"zlib",modal:!0}},p=t=>{localStorage.setItem(w,JSON.stringify(t))},Gt=t=>{if(t.stopPropagation(),t.target){const e=u(),s=t.target;e.layer=s.value==="1",p(e)}},kt=t=>{const e=u(),s=t.children[e.layer?1:0];s.selected=!0},Ht=()=>{const t=document.getElementById(Ut);t&&(kt(t),t.addEventListener(c.CHANGE,e=>{Gt(e)}))},Yt=t=>{const e=u(),s=t.children,n=s.length;for(let o=0;o<n;++o){const i=s[o];if(e.type===i.value){i.selected=!0;break}}},zt=t=>{if(t.stopPropagation(),t.target){const e=u(),s=t.target;e.type=s.value,p(e)}},Xt=()=>{const t=document.getElementById(bt);t&&(Yt(t),t.addEventListener(c.CHANGE,e=>{zt(e)}))},Ft=t=>{if(t.stopPropagation(),t.target){const e=u(),s=t.target;e.modal=s.value==="1",p(e)}},Wt=t=>{const e=u(),s=t.children[e.modal?0:1];s.selected=!0},Vt=()=>{const t=document.getElementById(Dt);t&&(Wt(t),t.addEventListener(c.CHANGE,e=>{Ft(e)}))},Kt="0.250.0",jt=()=>{const t=document.getElementById(Bt);t&&(t.textContent=`Î² version: ${Kt}`)};let S=0;const Zt=()=>{O(),window.addEventListener("resize",()=>{clearTimeout(S),S=setTimeout(()=>{O()},200)}),Ht(),Xt(),Vt(),jt()};class qt extends Rt{constructor(){super($)}move(e){return e.style.left=`${this.offsetLeft}px`,e.style.top=`${this.offsetTop}px`,e}initialize(){Zt()}}const L=[qt],Jt=async()=>{const t=[];for(let e=0;e<L.length;++e){const s=L[e],n=new s;n.initialize&&t.push(n.initialize())}await Promise.all(t)},C="stage",Qt="stage-area",te="screen",ee=t=>{const e=document.getElementById(C);e&&(e.style.width=`${t.width}px`,e.style.height=`${t.height}px`,e.style.backgroundColor=t.bgColor)},se=()=>{const t=document.getElementById(Z);t&&(t.value="100")},ne="library-preview-area",oe=t=>{const e=document.getElementById(ne);e&&(e.style.backgroundColor=t)},re=550,ie=400,ce=24,le="#ffffff",ae="stage-width",ue="stage-height",$e="stage-fps",he="stage-bgColor",de="stage-lock",_e=t=>{const e=document.getElementById(ae);e&&(e.value=`${t.width}`);const s=document.getElementById(ue);s&&(s.value=`${t.height}`);const n=document.getElementById($e);n&&(n.value=`${t.fps}`);const o=document.getElementById(he);o&&(o.value=t.bgColor);const i=document.getElementById(de);i&&i.children.length&&i.children[0].setAttribute("class",t.lock?"active":"disable")},fe="label-name",ge=(t="")=>{const e=document.getElementById(fe);e&&(e.value=t)},Ee=t=>{const e=document.getElementById(Qt);e&&(e.style.width=`${t.width+window.screen.width}px`,e.style.height=`${t.height+window.screen.height}px`)},me=t=>{const e=document.getElementById(te);e&&(e.scrollLeft=window.screen.width/2-(e.clientWidth-t.width)/2,e.scrollTop=window.screen.height/2-(e.clientHeight-t.height)/2)},pe=()=>{const t=document.getElementById(C);t&&(et(t.offsetLeft),st(t.offsetTop))},Te=t=>{ee(t),se(),oe(t.bgColor),_e(t),ge(""),Ee(t),me(t),pe()};class Oe{constructor(){r(this,"_$width");r(this,"_$height");r(this,"_$fps");r(this,"_$bgColor");r(this,"_$lock");this._$width=re,this._$height=ie,this._$fps=ce,this._$bgColor=le,this._$lock=!1}get width(){return this._$width}set width(e){this._$width=f(+e,1,1024*4)}get height(){return this._$height}set height(e){this._$height=f(+e,1,1024*4)}get fps(){return this._$fps}set fps(e){this._$fps=f(e|0,1,60)}get bgColor(){return this._$bgColor}set bgColor(e){this._$bgColor=`${e}`.toLowerCase()}get lock(){return this._$lock}set lock(e){this._$lock=!!e}run(){Te(this)}toObject(){return{width:this.width,height:this.height,fps:this.fps,bgColor:this.bgColor,lock:this.lock}}load(e){this._$width=e.width,this._$height=e.height,this._$fps=e.fps,this._$bgColor=e.bgColor,this._$lock=e.lock}}class Se{constructor(){r(this,"_$name");r(this,"_$stage");r(this,"_$libraries");this._$name="",this._$stage=new Oe,this._$libraries=new Map}get name(){return this._$name}set name(e){this._$name=`${e}`}get root(){return this._$libraries.get(0)}get stage(){return this._$stage}run(){this._$stage.run()}}const x=[Ct,Jt],v=()=>{const t=[];for(let e=0;e<x.length;++e){const s=x[e];t.push(s())}return Promise.all(t)},I=()=>{new Se().run()};if(document.readyState==="loading"){const t=e=>{e.target&&(e.target.removeEventListener("DOMContentLoaded",t),v().then(I))};window.addEventListener("DOMContentLoaded",t)}else v().then(I);
